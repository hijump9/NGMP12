<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>종합재무설계 고객 상담 대시보드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js is no longer needed but keeping it as a fallback in case other features use it, though I'll remove its usage -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f5f5f4; }
        .tab-btn.active { 
            background-color: #1e40af; 
            color: white; 
            font-weight: 700; 
            border-bottom: 4px solid #172554;
        }
        .tab-btn {
            color: #64748b;
            font-weight: 500;
        }
        .card-shadow { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
        /* .chart-container is removed */
        /* input[type=range] styles removed */
        /* Style for line-through on checked items */
        .checklist-item input:checked + div { text-decoration: line-through; color: #9ca3af; }
    </style>
</head>
<body class="text-stone-800 h-screen flex flex-col overflow-hidden">

    <!-- 1. Header & Client Selector -->
    <header class="bg-white border-b border-stone-200 z-50 flex-none">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <div>
                <h1 class="text-xl font-black text-blue-900 tracking-tight">종합재무설계 제안서</h1>
                <p class="text-xs text-stone-500 mt-1">고객을 위한 맞춤 제안</p>
            </div>
            <div class="flex items-center gap-3">
                <span class="text-sm font-bold text-stone-600">상담 고객:</span>
                <select id="clientSelector" onchange="changeClient()" class="bg-stone-100 border-none rounded-lg px-4 py-2 text-sm font-bold text-blue-900 focus:ring-2 focus:ring-blue-500 cursor-pointer">
                    <option value="client1">이승현</option>
                    <option value="client2">김민정</option>
                </select>
            </div>
        </div>
    </header>

    <!-- 2. Main Navigation Tabs -->
    <nav class="bg-white border-b border-stone-200 shadow-sm flex-none z-40 overflow-x-auto">
        <div class="max-w-6xl mx-auto flex whitespace-nowrap">
            <button onclick="showTab(1)" class="tab-btn active px-6 py-4 transition-all" id="btn-1">1️⃣ 기본정보</button>
            <button onclick="showTab(2)" class="tab-btn px-6 py-4 transition-all" id="btn-2">2️⃣ 재무현황</button>
            <button onclick="showTab(3)" class="tab-btn px-6 py-4 transition-all" id="btn-3">3️⃣ 소득·지출</button>
            <button onclick="showTab(4)" class="tab-btn px-6 py-4 transition-all" id="btn-4">4️⃣ 단기 목표</button>
            <button onclick="showTab(5)" class="tab-btn px-6 py-4 transition-all" id="btn-5">5️⃣ 중기 목표</button>
            <button onclick="showTab(6)" class="tab-btn px-6 py-4 transition-all" id="btn-6">6️⃣ 장기 목표</button>
            <button onclick="showTab(7)" class="tab-btn px-6 py-4 transition-all" id="btn-7">✅ 실천사항</button>
        </div>
    </nav>

    <!-- 3. Main Content Area -->
    <main class="flex-grow overflow-y-auto bg-stone-50 p-4 pb-20">
        <div class="max-w-4xl mx-auto">
            
            <!-- Tab 1: Basic Info & Focus Area -->
            <div id="tab-1" class="tab-content block animate-fade-in">
                <div class="bg-white rounded-2xl p-8 card-shadow text-center mb-6">
                    <div class="w-24 h-24 bg-blue-100 rounded-full mx-auto flex items-center justify-center text-4xl mb-6">👤</div>
                    <h2 class="text-3xl font-black text-stone-800 mb-6" id="info-name">이승현 고객님</h2>
                    
                    <!-- 통합된 기본 정보 박스 -->
                    <div class="bg-stone-50 p-6 rounded-xl border border-stone-200 max-w-lg mx-auto text-left">
                        <h3 class="text-lg font-bold text-stone-700 mb-4 border-l-4 border-blue-500 pl-3">고객 기본 정보</h3>
                        <div class="grid grid-cols-2 gap-x-4 gap-y-3 text-sm">
                            <div class="flex justify-between border-b border-stone-200 pb-1">
                                <span class="text-stone-500">나이/성별:</span>
                                <span class="font-bold text-stone-700" id="info-age-gender"></span>
                            </div>
                            <div class="flex justify-between border-b border-stone-200 pb-1">
                                <span class="text-stone-500">결혼 여부:</span>
                                <span class="font-bold text-stone-700" id="info-marital"></span>
                            </div>
                            <div class="flex justify-between border-b border-stone-200 pb-1">
                                <span class="text-stone-500">직업:</span>
                                <span class="font-bold text-stone-700" id="info-job"></span>
                            </div>
                            <div class="flex justify-between border-b border-stone-200 pb-1">
                                <span class="text-stone-500">가구 형태:</span>
                                <span class="font-bold text-stone-700" id="info-type"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Focus Area Section -->
                <div class="bg-white rounded-2xl p-6 card-shadow border-t-8 border-indigo-500 mb-6">
                    <h3 class="text-xl font-black text-indigo-800 mb-4 flex items-center gap-2">
                        <span class="text-2xl">🎯</span> 우선순위 (Focus Area)
                    </h3>
                    <ol id="focus-area-list" class="list-decimal list-inside space-y-3 pl-2 text-base text-stone-700">
                        <!-- JS Injected -->
                    </ol>
                </div>
                
                <div class="bg-blue-900 text-white p-6 rounded-xl text-center font-medium shadow-lg">
                    <p class="text-lg" id="info-quote">“이 설계는 고객님의 현재 상황을 기준으로 시작합니다.”</p>
                </div>
            </div>

            <!-- Tab 2: Financial Status -->
            <div id="tab-2" class="tab-content hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <!-- Assets -->
                    <div class="bg-white rounded-2xl p-6 card-shadow border-l-8 border-blue-500">
                        <h3 class="text-xl font-bold mb-4 text-stone-700">💰 자산 (내가 가진 것)</h3>
                        <div class="space-y-4" id="status-assets">
                            <!-- JS Injected -->
                        </div>
                    </div>
                    <!-- Liabilities -->
                    <div class="bg-white rounded-2xl p-6 card-shadow border-l-8 border-red-400">
                        <h3 class="text-xl font-bold mb-4 text-stone-700">📉 부채 (관리해야 할 것)</h3>
                        <div class="space-y-4" id="status-liabilities">
                             <!-- JS Injected -->
                        </div>
                    </div>
                </div>
                
                <div class="bg-stone-200 text-stone-700 p-6 rounded-xl text-center font-bold">
                    <p id="status-quote"></p>
                </div>
            </div>

            <!-- Tab 3: Income & Expenses -->
            <div id="tab-3" class="tab-content hidden">
                <div class="bg-white rounded-2xl p-8 card-shadow text-center mb-6">
                    <h3 class="text-stone-400 text-sm font-bold uppercase tracking-wide mb-2">월 소득 (세후 기준)</h3>
                    <p class="text-4xl font-black text-blue-600 mb-8" id="cash-income"></p>
                    
                    <div class="flex flex-col md:flex-row gap-4 items-stretch justify-center">
                        <div class="flex-1 bg-red-50 p-4 rounded-xl border border-red-100">
                            <span class="block text-red-500 text-xs font-bold mb-1">💸 월 지출</span>
                            <div class="text-sm text-stone-600 mb-1" id="cash-expense-detail"></div>
                            <strong class="text-xl text-stone-800" id="cash-expense"></strong>
                            <div id="expense-feedback" class="mt-3 text-xs text-red-700 font-medium bg-red-100 p-3 rounded hidden text-left"></div>
                        </div>
                        <div class="flex-none flex items-center justify-center text-stone-300 text-2xl">
                            ➔
                        </div>
                        <div class="flex-1 bg-emerald-50 p-4 rounded-xl border border-emerald-100">
                            <span class="block text-emerald-600 text-xs font-bold mb-1">🌱 저축 가능액</span>
                            <strong class="text-2xl text-emerald-700" id="cash-savings"></strong>
                        </div>
                    </div>
                </div>
                <div class="bg-emerald-600 text-white p-6 rounded-xl text-center font-bold shadow-lg">
                    <p id="cash-quote"></p>
                </div>
            </div>

            <!-- Tab 4: Short Term Goal -->
            <div id="tab-4" class="tab-content hidden">
                <div class="bg-white rounded-2xl p-6 card-shadow mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-stone-800">🌱 단기 재무목표</h3>
                        <span id="short-possibility-badge" class="px-3 py-1 rounded-full text-xs font-bold"></span>
                    </div>
                    <ul class="space-y-3 mb-6" id="short-goals">
                        <!-- JS Injected (Total required funds will be highlighted here) -->
                    </ul>
                    <div class="bg-emerald-50 p-4 rounded-xl border border-emerald-100">
                        <h4 class="font-bold text-emerald-800 text-sm mb-2">💡 가능성 근거</h4>
                        <p class="text-sm text-stone-600 leading-relaxed" id="short-analysis"></p>
                    </div>
                </div>

                <div class="bg-white rounded-2xl p-6 card-shadow mb-6">
                    <h4 class="font-bold text-stone-700 mb-3">📌 단기 자금 관리 원칙</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 text-center text-sm" id="short-principles">
                        <!-- JS Injected -->
                    </div>
                </div>
            </div>

            <!-- Tab 5: Mid Term Goal (Interactive) -->
            <div id="tab-5" class="tab-content hidden">
                <div class="bg-white rounded-2xl p-6 card-shadow mb-6">
                    <h3 class="text-xl font-bold text-stone-800 mb-2">🏠 중기 재무목표 (1~10년)</h3>
                    <p class="text-stone-500 text-sm mb-6">주거 안정과 교육 자금을 준비하는 시기입니다.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6" id="mid-goals">
                        <!-- JS Injected -->
                    </div>
                </div>

                <!-- Mid-Term Investment Proposal (ISA) -->
                <div class="bg-indigo-50 rounded-2xl p-6 card-shadow mb-6 border-l-4 border-indigo-500">
                    <h4 class="font-bold text-xl text-indigo-800 mb-3">
                        🎯 중기 목표 달성을 위한 투자 수단 (ISA 활용 극대화)
                    </h4>
                    <div id="mid-inv-recommendation">
                        <!-- ISA content will be injected here by JS -->
                    </div>
                </div>

                <!-- Removed Interactive Chart Section (based on user request) -->
                
                 <div class="bg-stone-800 text-white p-6 rounded-xl text-center font-bold shadow-lg">
                    <p id="mid-quote"></p>
                </div>
            </div>

            <!-- Tab 6: Long Term Goal (Goals, Investment, Risk) -->
            <div id="tab-6" class="tab-content hidden">
                
                <!-- 6-1. 장기 목표 현황 -->
                <div class="bg-white rounded-2xl p-6 card-shadow mb-6">
                     <h3 class="text-xl font-bold text-stone-800 mb-4 border-l-4 border-purple-500 pl-3">
                         ⏳ 장기 목표 및 달성 계획
                     </h3>
                     <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Left: Goals -->
                        <div>
                            <h4 class="font-bold text-stone-600 mb-3 border-b pb-2">🎯 핵심 장기 목표 (10년+)</h4>
                            <div class="space-y-4" id="long-goals"></div>
                            <div class="mt-4 bg-stone-50 p-3 rounded-lg text-sm text-stone-600" id="long-analysis"></div>
                        </div>
                        
                        <!-- Right: Insurance (Risk) -->
                        <div class="border-l-0 lg:border-l border-stone-100 lg:pl-6">
                            <h4 class="font-bold text-stone-600 mb-3 border-b pb-2">🛡️ 위험 관리 (보험)</h4>
                            <p class="text-xs text-stone-500 mb-3">보험은 이 설계가 중간에 무너지지 않게 지켜주는 장치입니다.</p>
                            <ul class="space-y-3 text-sm" id="insurance-list"></ul>
                        </div>
                     </div>
                </div>

                <!-- 6-2. 투자 제안 (Retirement Focused) -->
                <div class="bg-white rounded-2xl p-6 card-shadow mb-6">
                    <h3 class="text-xl font-black text-blue-800 mb-4 border-l-4 border-blue-500 pl-3">
                        💰 노후 자금 운용 제안 (Tax Advantage Focus)
                    </h3>
                    <p class="text-stone-500 text-sm mb-6" id="long-inv-summary"></p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="long-inv-recommendations">
                        <!-- Investment cards will be injected here -->
                    </div>
                </div>
            </div>

            <!-- Tab 7: Checklist (4분면) -->
            <div id="tab-7" class="tab-content hidden">
                <div class="bg-white rounded-2xl p-8 card-shadow mb-6">
                    <h3 class="text-2xl font-black text-stone-800 mb-6">
                        ✅ 고객 실천사항 체크리스트
                    </h3>

                    <!-- 진행률 -->
                    <div class="mb-8">
                        <div class="flex justify-between text-sm font-bold mb-2">
                            <span>진행률</span>
                            <span id="progress-text">0%</span>
                        </div>
                        <div class="w-full bg-stone-200 rounded-full h-4">
                            <div id="progress-bar"
                                class="bg-blue-600 h-4 rounded-full transition-all duration-500"
                                style="width:0%"></div>
                        </div>
                        <div class="text-right mt-1 text-xs font-bold text-stone-500"
                            id="progress-status">🔴 시작 필요</div>
                    </div>

                    <!-- 🔲 4분면 레이아웃 -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                        <div class="bg-stone-50 p-5 rounded-xl border">
                            <h4 class="font-bold mb-4 border-l-4 border-emerald-500 pl-3">
                                🌱 단기 (지금~1년)
                            </h4>
                            <div id="checklist-short" class="space-y-2"></div>
                        </div>

                        <div class="bg-stone-50 p-5 rounded-xl border">
                            <h4 class="font-bold mb-4 border-l-4 border-blue-500 pl-3">
                                🏠 중기 (1~10년)
                            </h4>
                            <div id="checklist-mid" class="space-y-2"></div>
                        </div>

                        <div class="bg-stone-50 p-5 rounded-xl border">
                            <h4 class="font-bold mb-4 border-l-4 border-purple-500 pl-3">
                                ⏳ 장기 (10년+)
                            </h4>
                            <div id="checklist-long" class="space-y-2"></div>
                        </div>

                        <div class="bg-stone-50 p-5 rounded-xl border">
                            <h4 class="font-bold mb-4 border-l-4 border-red-500 pl-3">
                                🛡️ 위험관리
                            </h4>
                            <div id="checklist-risk" class="space-y-2"></div>
                        </div>

                    </div>
                </div>

                <div class="bg-indigo-900 text-white p-6 rounded-xl text-center shadow-lg">
                    <p class="text-lg font-bold mb-2">🔑 전체 요약</p>
                    <p class="font-medium opacity-90" id="final-summary"></p>
                </div>
            </div>

        </div>
    </main>

    <script>
        // --- Data Definitions ---
        // Note: All values are in Korean Won (KRW). 
        // For calculation simplicity and display, 10,000 KRW = 1 unit internally (만원)
        const clients = {
            client1: {
                info: {
                    name: "이승현", age: "40세", type: "1인 가구", marital: "미혼", gender: "남성", job: "직장인",
                    quote: "“이 설계는 고객님의 현재 상황을 기준으로 시작합니다.”"
                },
                focusArea: [ 
                    "예기치 못한 상황에서도 생활이 흔들리지 않는 안정성 확보",
                    "결혼 이후 지출 구조 변화에 대응 가능한 현금흐름 유지",
                    "중기 내 주거 선택을 가능하게 하는 자기자본 형성",
                    "장기 노후자산의 조기 준비"
                ],
                status: {
                    assets: [
                        { name: "현금성 자산", val: "2,000만 원", icon: "💵" },
                        { name: "전세 보증금 (본인)", val: "1억 원", icon: "🏠" },
                        { name: "전세대출", val: "2억 원", icon: "🏦" }
                    ],
                    liabilities: [
                        { name: "전세자금대출", val: "2억 원", desc: "상환 대상이 아닌 '관리 대상 부채'" }
                    ],
                    quote: "“현재 재무 상태는 안정적이지만, 큰 생애 이벤트를 대비한 구조 정리가 필요한 단계입니다.”"
                },
                cashflow: {
                    income: "500만 원",
                    expense: "250만 원",
                    expenseDetail: "소비성 200만 + 비소비성 50만",
                    savings: "250만 원",
                    quote: "“이 저축 가능 금액 250만원을 목적별로 ISA(100만)+연금(50만)+단기(100만)로 나누어 관리합니다.”",
                    feedback: null
                },
                short: {
                    badge: "가능 (높음)",
                    badgeColor: "bg-emerald-100 text-emerald-700",
                    goals: [
                        { name: "차량", val: "1,000만 원" },
                        { name: "결혼", val: "2,000만 원" },
                        { name: "초기 육아", val: "1,000만 원" },
                        { name: "총 필요 자금", val: "4,000만 원" } // Target item for highlighting
                    ],
                    analysis: "기존 자산(2,000만)과 월 단기 적립/여유자금(100만)으로 대출 없이 준비 가능한 목표입니다. (예상 24~30개월)",
                    principles: ["📉 투자 금지", "🛡️ 원금 보존 위주", "🔄 달성 후 중기 전환"]
                },
                mid: {
                    goals: [
                        { title: "내 집 마련", target: "자기자본 1억 8천", desc: "목표 주택 5억 (대출 병행 전제)<br>ISA 100만 원 적립으로 속도 가속" },
                        { title: "자녀 교육", target: "1억 원", desc: "월 100만원 중기 자금 내에서 유연하게 준비" }
                    ],
                    investment: {
                        name: "ISA (개인종합자산관리계좌)",
                        amount: "100만 원",
                        purpose: "내 집 마련 자기자본 극대화 (비과세 활용)",
                        desc: "ISA 납입 한도를 활용하여 중기 목표(내 집 마련) 자금을 최대한 빠르게 비과세로 성장시키는 핵심 전략입니다. 3년 의무 거치 기간을 지나면 주택 매매 시점까지 유동적으로 활용 가능합니다.",
                        focus: "Housing Down Payment Maximization"
                    },
                    quote: "“월 100만원 ISA 적립을 통해 중기 목표 달성 속도를 획기적으로 높입니다.”",
                    chartData: {
                        // The raw accumulation data is kept for future manual reference if needed.
                        initial: 10000, // 1억 (전세 본인자금)
                        targetLine1: 18000, // 1.8억
                        label1: "자기자본 목표 (1.8억)",
                        calculatedAccumulation: [
                            12520, 26041.6, 40644.9, 56416.5, 73449.8, 
                            91845.8, 111713.5, 133170.6, 156344.2, 181371.8
                        ]
                    }
                },
                long: {
                    goals: [
                        { title: "자녀 결혼 자금", val: "1억 원 (지원 가능 범위)", desc: "부담을 나누고 시간을 길게 가져가 준비" },
                        { title: "노후 자금", val: "월 50만 원 적립", desc: "세액공제 혜택을 효율적으로 활용하여 준비" } 
                    ],
                    analysis: "ISA 자금을 중기에 집중하고, 노후 자금은 세액공제 한도 내에서 최대한 효율적으로 운용합니다.",
                    insurance: [
                        { name: "실손의료보험", role: "기본 의료비 리스크 차단" },
                        { name: "3대 질병 진단비", role: "질병 소득 공백 대응" }
                    ],
                    investment: {
                        summary: "ISA 자금(100만원)을 중기로 완전히 분리하고, 나머지 50만원을 세액공제 혜택을 극대화하는 순수 노후 자금 운용에 집중합니다. (세액공제 연간 600만원) ",
                        recommendations: [
                            { name: "IRP (개인형 퇴직연금)", amount: "30만 원", strategy: "세액공제 한도 우선 확보를 위한 핵심 상품" },
                            { name: "연금저축펀드", amount: "20만 원", strategy: "추가 세액공제 및 장기 분산 투자 (ETF 활용)" },
                        ]
                    }
                },
                checklist: {
                    short: ["비상자금 계좌 유지", "결혼·차량 자금 분리", "단기 자금 투자하지 않기"],
                    mid: ["주거 자금 전용 ISA 계좌 개설", "월 100만원 ISA 자동이체 설정", "교육자금 분리"],
                    long: ["연금 계좌 (IRP/연금저축) 유지", "노후 자금 중도 사용 안 하기", "자녀 결혼자금 범위 설정"],
                    risk: ["실손보험 유지", "3대 질병 보장 점검"],
                    summary: "“이 설계는 돈을 빨리 불리는 계획이 아니라, 인생의 중요한 순간마다 선택할 수 있게 만드는 설계입니다.”"
                }
            },
            client2: {
                info: {
                    name: "김민정", age: "35세", type: "3인 가구", job: "맞벌이", marital: "기혼", gender: "여성",
                    quote: "“이 설계는 가족의 생활이 중단되지 않도록 만드는 구조입니다.”"
                },
                focusArea: [
                    "가족 단위 위험관리",
                    "자녀 교육자금 준비",
                    "주거 안정",
                    "부부 노후자산 형성"
                ],
                status: {
                    assets: [
                        { name: "유동성 자금", val: "5,000만 원", icon: "💵" },
                        { name: "전세 보증금 (본인)", val: "2억 원", icon: "🏠" },
                        { name: "전세대출", val: "2억 원", icon: "🏦" }
                    ],
                    liabilities: [
                        { name: "전세자금대출", val: "2억 원", desc: "상환 대상 ❌ / 관리 대상 부채 ⭕" }
                    ],
                    quote: "“현재는 자산 규모보다 자금의 안전성과 쓰임 구분이 더 중요한 단계입니다.”"
                },
                cashflow: {
                    income: "800만 원 (부부 합산)",
                    expense: "600만 원",
                    expenseDetail: "소비성 400만 + 비소비성 200만",
                    savings: "200만 원",
                    quote: "“총 200만원의 저축액을 ISA(부부 각 50만)+연금(부부 각 50만)으로 분배합니다. 단기/버퍼 자금 확보를 위해 지출 절감이 필수입니다.”",
                    feedback: "🔎 <strong>지출 점검:</strong> 외식·배달, 구독 서비스 등에서 50~100만 원 절감 시 중기·교육자금에 추가 투입 가능합니다."
                },
                short: {
                    badge: "매우 높음",
                    badgeColor: "bg-blue-100 text-blue-700",
                    goals: [
                        { name: "차량(중고)", val: "1,000만 원" },
                        { name: "육아 자금", val: "1,000만 원" },
                        { name: "총 필요 자금", val: "2,000만 원" } // Target item for highlighting
                    ],
                    analysis: "기존 유동성 자금(5,000만) 중 2,000만원을 확보하여 단기 목표를 달성합니다. 월 저축액 200만원은 ISA와 연금으로 전액 배분되어, 지출 절감을 통한 비상금 추가 확보가 중요합니다.",
                    principles: ["📉 투자 금지", "🛡️ CMA 원금 안정 자산", "🔄 남는 자금 중기 이관"]
                },
                mid: {
                    goals: [
                        { title: "내 집 마련", target: "자기자본 1억 8천", desc: "목표 주택 6억<br>ISA 100만 원 적립으로 비과세 이점 활용" },
                        { title: "자녀 교육", target: "1억 원 (원금 보장)", desc: "수익보다 확정성 우선<br>월 100만원 중기 자금 내에서 준비" }
                    ],
                    investment: {
                        name: "ISA (부부 공동 투자 계좌)",
                        amount: "100만 원", // 월 50만원 x 2명
                        purpose: "주거/교육 목표 달성을 위한 부부 공동 비과세 성장 자금",
                        desc: "부부 각각 50만원씩 ISA 계좌를 개설하여 월 100만원 한도를 적극 활용하며, 가족의 중기 목표(주거, 교육)를 위한 자금의 규모를 빠르게 키우고 비과세 혜택을 극대화합니다.",
                        focus: "Housing & Education Fund Maximization (Joint)"
                    },
                    quote: "“월 100만원 ISA 적립을 통해 중기 목표 달성 속도를 획기적으로 높이고, 자금의 유연성을 확보합니다.”",
                    chartData: {
                        // The raw accumulation data is kept for future manual reference if needed.
                        initial: 20000, // 2억 (전세 본인자금) 
                        targetLine1: 18000, // 1.8억
                        label1: "자기자본 목표 (1.8억)",
                        calculatedAccumulation: [
                            22520, 36041.6, 50644.9, 66416.5, 83449.8, 
                            101845.8, 121713.5, 143170.6, 166344.2, 191371.8
                        ]
                    }
                },
                long: {
                    goals: [
                        { title: "자녀 결혼 자금", val: "8천~1억 원", desc: "지원 가능 범위 (의무 X)<br>아주 긴 시간에 걸쳐 준비" },
                        { title: "부부 노후 자금", val: "월 100만 원 적립", desc: "맞벌이 부부의 세액공제 한도를 효율적으로 활용하여 준비" }
                    ],
                    analysis: "ISA 자금(100만원)을 중기로 완전히 분리하고, 나머지 100만원 전액을 부부의 세액공제 한도를 활용하는 연금저축펀드에 집중하여 장기 목표를 달성합니다.",
                    insurance: [
                        { name: "실손의료보험 (부부)", role: "의료비 기본 방어" },
                        { name: "3대 질병 진단비 (부부)", role: "질병 소득 공백 대비" },
                        { name: "정기보험 (주 소득자)", role: "가족 생계 보호 (수익 X, 안전 O)" }
                    ],
                    investment: {
                        summary: "ISA 자금(100만원)을 중기로 완전히 분리하고, 나머지 100만원 전액을 부부의 세액공제 한도를 활용하는 연금저축펀드에 집중하여 장기 목표를 달성합니다.",
                        recommendations: [
                            { name: "연금저축펀드 (본인)", amount: "50만 원", strategy: "세액공제 한도 우선 확보 및 장기 분산 투자 (ETF 활용)" },
                            { name: "연금저축펀드 (남편)", amount: "50만 원", strategy: "추가 세액공제 확보 및 장기 자산 배분" },
                        ]
                    }
                },
                checklist: {
                    short: ["CMA 계좌로 단기 자금 분리", "차량·육아자금 사용 계획 확정", "월 50만원 지출 절감 실행"],
                    mid: ["부부 ISA 계좌 각각 개설", "월 50만원씩 ISA 자동이체 설정", "교육자금 분리"],
                    long: ["부부 연금저축펀드 계좌 각각 개설", "월 50만원씩 연금저축펀드 자동이체 설정", "노후 자금 중도 사용 안 하기"],
                    risk: ["실손보험 유지", "3대 질병 보장 점검"],
                    summary: "“이 설계는 자산을 빠르게 늘리는 계획이 아니라, 아이 키우는 동안 돈 때문에 선택을 포기하지 않게 만드는 구조입니다.”"
                }
            }
        };
        
        // Helper function for display formatting
        function formatKRW(amount) {
            // Converts internal unit (만원) to '억' and '천만원' for display
            // amount is in units of 10,000 KRW
            const totalEok = Math.floor(amount / 10000);
            const remainderCheon = Math.floor((amount % 10000) / 1000);
            const total = totalEok * 10000 + remainderCheon * 1000;
            
            if (totalEok > 0) {
                // Remove the "천만원" if it's 0 (e.g., 2억 0천만원 -> 2억)
                return `${totalEok}억` + (remainderCheon > 0 ? ` ${remainderCheon}천만원` : '');
            } else {
                return `${remainderCheon}천만원`;
            }
        }

        // --- Logic ---
        let currentClientId = 'client1';
        // let chartInstance = null; // Removed

        function init() {
            showTab(1);
            // Check if client2 is selected from a previous session (e.g., if the user is refreshing)
            const selector = document.getElementById('clientSelector');
            currentClientId = selector.value; 
            renderClientData();
        }

        function changeClient() {
            const selector = document.getElementById('clientSelector');
            currentClientId = selector.value;
            renderClientData();
            // Chart rendering logic removed
        }

        function showTab(tabIndex) {
            document.querySelectorAll('.tab-btn').forEach((btn, idx) => {
                btn.classList.toggle('active', idx + 1 === tabIndex);
            });
            document.querySelectorAll('.tab-content').forEach((content, idx) => {
                if (idx + 1 === tabIndex) {
                    content.classList.remove('hidden');
                    content.classList.add('block');
                } else {
                    content.classList.remove('block');
                    content.classList.add('hidden');
                }
            });
            // if(tabIndex === 5) setTimeout(renderChart, 100); // Chart rendering call removed
        }

        /**
         * 4분면 레이아웃에 맞춰 체크리스트를 렌더링하는 함수
         */
        function renderChecklistSection(items, elementId) {
            const el = document.getElementById(elementId);
            if (!items || items.length === 0) {
                el.innerHTML = `<p class="text-xs text-stone-400">해당 항목 없음</p>`;
                return;
            }
            el.innerHTML = items.map(item => `
                <label class="checklist-item flex items-center gap-3 cursor-pointer p-2 hover:bg-white rounded-lg">
                    <input type="checkbox"
                        onchange="updateProgress()"
                        class="w-5 h-5 text-blue-600 rounded">
                    <div class="text-stone-600 font-medium">${item}</div>
                </label>
            `).join('');
        }

        function renderClientData() {
            const data = clients[currentClientId];

            // Tab 1
            document.getElementById('info-name').innerText = data.info.name + " 고객님";
            
            // 통합된 정보 필드 업데이트
            document.getElementById('info-age-gender').innerText = `${data.info.age} / ${data.info.gender}`;
            document.getElementById('info-marital').innerText = data.info.marital;
            document.getElementById('info-job').innerText = data.info.job;
            document.getElementById('info-type').innerText = data.info.type;
            
            document.getElementById('info-quote').innerText = data.info.quote;

            // Focus Area List
            const focusHtml = data.focusArea.map(item => 
                `<li class="hover:text-indigo-600 transition duration-150">${item}</li>`
            ).join('');
            document.getElementById('focus-area-list').innerHTML = focusHtml;


            // Tab 2
            const assetHtml = data.status.assets.map(a => 
                `<div class="flex justify-between items-center bg-stone-50 p-3 rounded-lg"><span class="text-stone-500">${a.icon} ${a.name}</span><strong class="text-stone-800">${a.val}</strong></div>`
            ).join('');
            document.getElementById('status-assets').innerHTML = assetHtml;
            const liabHtml = data.status.liabilities.map(l => 
                `<div class="bg-red-50 p-3 rounded-lg"><div class="flex justify-between items-center mb-1"><span class="text-red-500 font-bold">${l.name}</span><strong class="text-stone-800">${l.val}</strong></div><p class="text-xs text-red-400">${l.desc}</p></div>`
            ).join('');
            document.getElementById('status-liabilities').innerHTML = liabHtml;
            document.getElementById('status-quote').innerText = data.status.quote;

            // Tab 3
            document.getElementById('cash-income').innerText = data.cashflow.income;
            document.getElementById('cash-expense').innerText = data.cashflow.expense;
            document.getElementById('cash-expense-detail').innerText = data.cashflow.expenseDetail;
            document.getElementById('cash-savings').innerText = data.cashflow.savings;
            document.getElementById('cash-quote').innerText = data.cashflow.quote;
            const feedbackEl = document.getElementById('expense-feedback');
            if(data.cashflow.feedback) {
                feedbackEl.innerHTML = data.cashflow.feedback;
                feedbackEl.classList.remove('hidden');
            } else {
                feedbackEl.classList.add('hidden');
            }

            // Tab 4 (MODIFIED: Total Required Funds highlighting)
            document.getElementById('short-possibility-badge').innerText = data.short.badge;
            document.getElementById('short-possibility-badge').className = `px-3 py-1 rounded-full text-xs font-bold ${data.short.badgeColor}`;
            
            const goals = data.short.goals;
            const shortHtml = goals.map((g, index) => {
                const isTotal = (index === goals.length - 1);
                const baseClasses = "flex justify-between pb-2";
                
                if (isTotal) {
                    // 총 필요 자금 항목 강조
                    return `
                        <li class="${baseClasses} p-3 rounded-lg bg-blue-50 border-2 border-blue-200 font-extrabold text-lg transition-all duration-200 -mx-2 shadow-sm">
                            <span class="text-blue-800">${g.name}</span>
                            <span class="text-blue-600">${g.val}</span>
                        </li>
                    `;
                } else {
                    // 일반 항목
                    return `<li class="${baseClasses} border-b border-stone-100"><span class="text-stone-600">${g.name}</span><span class="font-bold text-stone-800">${g.val}</span></li>`;
                }
            }).join('');
            
            document.getElementById('short-goals').innerHTML = shortHtml;
            document.getElementById('short-analysis').innerText = data.short.analysis;
            const principlesHtml = data.short.principles.map(p => `<div class="bg-stone-50 p-3 rounded-lg border font-medium text-stone-600">${p}</div>`).join('');
            document.getElementById('short-principles').innerHTML = principlesHtml;

            // Tab 5
            const midHtml = data.mid.goals.map((g, i) => 
                `<div class="bg-blue-50 p-4 rounded-xl"><span class="bg-blue-200 text-blue-800 text-xs px-2 py-1 rounded mb-2 inline-block">목표 ${i+1}</span><h4 class="font-bold text-lg text-stone-800">${g.title}</h4><p class="text-blue-600 font-bold text-2xl my-1">${g.target}</p><p class="text-xs text-stone-500 leading-snug">${g.desc}</p></div>`
            ).join('');
            document.getElementById('mid-goals').innerHTML = midHtml;
            document.getElementById('mid-quote').innerText = data.mid.quote;

            // Tab 5 - ISA Recommendation
            const isaData = data.mid.investment;
            const midInvHtml = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- ISA Card -->
                    <div class="p-4 rounded-xl text-white bg-indigo-600 shadow-lg">
                        <span class="block text-xs font-bold mb-1 opacity-70">${isaData.focus}</span>
                        <h4 class="text-2xl font-extrabold mb-1">${isaData.name}</h4>
                        <p class="text-4xl font-black mt-2 mb-2">${isaData.amount} 월 적립</p>
                    </div>
                    <!-- Details -->
                    <div class="p-4 rounded-xl bg-indigo-100 text-indigo-900 border border-indigo-200">
                        <h5 class="font-bold text-lg mb-1">${isaData.purpose}</h5>
                        <p class="text-sm">${isaData.desc}</p>
                    </div>
                </div>
            `;
            document.getElementById('mid-inv-recommendation').innerHTML = midInvHtml;


            // Tab 6
            // 6-1. Long Goals
            const longGoalsHtml = data.long.goals.map(g => 
                `<div class="flex justify-between items-center border-b border-stone-100 pb-3"><div><strong class="block text-stone-700">${g.title}</strong><span class="text-xs text-stone-400">${g.desc}</span></div><span class="font-bold text-emerald-600">${g.val}</span></div>`
            ).join('');
            document.getElementById('long-goals').innerHTML = longGoalsHtml;
            document.getElementById('long-analysis').innerText = data.long.analysis;
            
            // 6-2. Insurance
            const insHtml = data.long.insurance.map(i => 
                `<li class="flex items-start gap-2"><span class="text-red-500">🛡️</span><div><strong class="text-stone-700">${i.name}</strong><p class="text-xs text-stone-500">${i.role}</p></div></li>`
            ).join('');
            document.getElementById('insurance-list').innerHTML = insHtml;

            // 6-3. Investment Recommendations (Retirement Only)
            const invData = data.long.investment;
            document.getElementById('long-inv-summary').innerText = invData.summary;
            const invHtml = invData.recommendations.map((r, i) => {
                // Two cards (IRP, Pension Fund)
                const colors = ['bg-blue-500', 'bg-teal-500'];
                const cardColor = colors[i % colors.length];
                return `
                    <div class="p-4 rounded-xl text-white ${cardColor} shadow-lg transition hover:shadow-xl">
                        <span class="block text-xs font-bold mb-1 opacity-70">추천 상품 ${i + 1}</span>
                        <h4 class="text-xl font-extrabold mb-1">${r.name}</h4>
                        <p class="text-3xl font-black mt-2 mb-2">${r.amount}</p>
                        <p class="text-xs opacity-90 border-t border-white/50 pt-2">${r.strategy}</p>
                    </div>
                `;
            }).join('');
            document.getElementById('long-inv-recommendations').innerHTML = invHtml;


            // Tab 7
            const cl = data.checklist;
            
            // 4분면 체크리스트 렌더링
            renderChecklistSection(cl.short, 'checklist-short');
            renderChecklistSection(cl.mid, 'checklist-mid');
            renderChecklistSection(cl.long, 'checklist-long');
            renderChecklistSection(cl.risk, 'checklist-risk');
            
            document.getElementById('final-summary').innerText = cl.summary;
            updateProgress(); // Initial progress calculation
        }

        // --- Chart Logic Removed ---

        /**
         * 체크리스트 진행률을 계산하고 UI를 업데이트하는 함수
         */
        function updateProgress() {
            // .checklist-item 내의 모든 input[type="checkbox"]를 선택
            const inputs = document.querySelectorAll('.checklist-item input[type="checkbox"]');
            const checked = document.querySelectorAll('.checklist-item input[type="checkbox"]:checked');
            const pct = inputs.length > 0 ? Math.round((checked.length / inputs.length) * 100) : 0;
            
            document.getElementById('progress-bar').style.width = `${pct}%`;
            document.getElementById('progress-text').innerText = `${pct}% 완료`;
            
            const statusText = document.getElementById('progress-status');
            const bar = document.getElementById('progress-bar');
            
            // 진행 상태에 따른 색상 및 텍스트 변경
            if(pct < 30) {
                bar.className = "bg-red-500 h-4 rounded-full transition-all duration-500";
                statusText.innerText = "🔴 시작 필요";
            } else if(pct < 70) {
                bar.className = "bg-yellow-500 h-4 rounded-full transition-all duration-500";
                statusText.innerText = "🟡 진행 중";
            } else {
                bar.className = "bg-green-500 h-4 rounded-full transition-all duration-500";
                statusText.innerText = "🟢 설계 실행 중";
            }
        }

        window.onload = init;
    </script>
</body>
</html>

